--
-- Main.lua
--
-- GetTalentInfo returns spellID
-- Talent SpellID data from https://wow.tools/dbc/?dbc=talent&build=1.13.5.35000#page=1
-------------------------------------------------------------------------------
-- GUB   shared data table between all parts of the addon
-------------------------------------------------------------------------------
local MyAddon, GUB = ...

GUB.Talents = {}

local GetTalentInfo = GetTalentInfo
local TalentSpellIDs = {}

--=============================================================================
-- Raw Data
--=============================================================================
local RawTalentSpellIDs = {
-- R1    R2    R3    R4    R5
11083,12351,
11094,13043,
11095,12872,12873,
11069,12338,12339,12340,12341,
11078,11080,12342,
11100,12353,
11366,
11103,12357,12358,12359,12360,
11108,12349,12350,
11113,
11115,11367,11368,
11119,11120,12846,12847,12848,
11124,12378,12398,12399,12400,
11129,
11070,12473,16763,16765,16766,
11071,12496,12497,
11151,12952,12953,
11165,12475,
11185,12487,12488,
11190,12489,12490,
11175,12569,12571,
11160,12518,12519,
11170,12982,12983,12984,12985,
11180,28592,28593,28594,28595,
12472,
11189,28332,
11426,
11958,
11207,12672,15047,15052,15053,
11210,12592,
11213,12574,12575,12576,12577,
11222,12839,12840,12841,12842,
11232,12500,12501,12502,12503,
6057,6085,
11237,12463,12464,16769,16770,
11242,12467,12469,
11247,12606,
11252,12605,
28574,
12043,
12042,
11255,12598,
12834,12849,12867,
12281,12812,12813,12814,12815,
12282,12663,12664,
12284,12701,12702,12703,12704,
12285,12697,
12286,12658,12659,
12287,12665,12666,
12289,12668,23695,
16462,16463,16464,16465,16466,
12290,12963,
12700,12781,12783,12784,12785,
12292,
12165,12830,12831,12832,12833,
12294,
12163,12711,12712,12713,12714,
12296,
12297,12750,12751,12752,12753,
12299,12761,12762,12763,12764,
12300,12959,12960,12961,12962,
12301,12818,
12302,12765,
12303,12788,12789,12791,12792,
12945,12307,12944,
12308,12810,12811,
12797,12799,12800,
23922,
12311,12958,
12312,12803,
12313,12804,12807,
12809,
12975,
12318,12857,12858,12860,12861,
12317,13045,13046,13047,13048,
12319,12971,12972,12973,12974,
12320,12852,12853,12855,12856,
12321,12835,12836,12837,12838,
12322,12999,13000,13001,13002,
12323,
12324,12876,12877,12878,12879,
12328,
12329,12950,20496,
23881,
12862,12330,20497,20498,20499,
13705,13832,13843,13844,13845,
13706,13804,13805,13806,13807,
13707,13966,13967,13968,13969,
13709,13800,13801,13802,13803,
13712,13788,13789,13790,13791,
13713,13853,13854,13855,13856,
13732,13863,
13733,13865,13866,
13741,13793,13792,
13742,13872,
13750,
13754,13867,
13715,13848,13849,13851,13852,
13743,13875,
13877,
13958,13970,13971,13972,13973,
13960,13961,13962,13963,13964,
13975,14062,14063,14064,14065,
13976,13979,13980,
13983,14070,14071,
13981,14066,
14057,14072,14073,14074,14075,
14076,14094,14095,
14079,14080,14081,
14082,14083,
14113,14114,14115,14116,14117,
14128,14132,14135,14136,14137,
14138,14139,14140,14141,14142,
14144,14148,
14156,14160,14161,
14158,14159,
14162,14163,14164,
14165,14166,14167,
14168,14169,
14174,14175,14176,
14177,
14179,
14186,14190,14193,14194,14195,
14185,
14251,
14278,
14531,14774,
10060,
14520,14780,14781,14782,14783,
14522,14788,14789,14790,14791,
14748,14768,14769,
14749,14767,
14524,14525,14526,14527,14528,
14747,14770,14771,
14521,14776,14777,
14751,
14750,14772,
14752,
14523,14784,14785,14786,14787,
14892,15362,15363,
14183,
14983,
14889,15008,15009,15010,15011,
14901,15028,15029,15030,15031,
14909,15017,
14898,15349,15354,15355,15356,
14908,15020,17191,
14912,15013,15014,
14913,15012,
27900,27901,27902,27903,27904,
14911,15018,
15058,15059,15060,
15237,
15257,15331,15332,15333,15334,
15259,15307,15308,15309,15310,
15260,15327,15328,15329,15330,
15268,15323,15324,15325,15326,
15270,15335,15336,15337,15338,
15318,15272,15320,
15273,15312,15313,15314,15316,
15275,15317,
15274,15311,
15286,
15407,
15473,
15487,
15392,15448,
16038,16160,16161,
16041,16117,16118,16119,16120,
16035,16105,16106,16107,16108,
16039,16109,16110,16111,16112,
16089,
16086,16544,
16043,16130,
16166,
16164,
16040,16113,16114,16115,16116,
16176,16235,16240,
16189,
16180,16196,16198,
16182,16226,16227,16228,16229,
16181,16230,16232,16233,16234,
16187,16205,16206,16207,16208,
16184,16209,
16190,
16188,
16178,16210,16211,16212,16213,
16179,16214,16215,16216,16217,
16194,16218,16219,16220,16221,
16173,16222,16223,16224,16225,
16254,16271,16272,16273,16274,
16256,16281,16282,16283,16284,
16262,16287,
16261,16290,16291,
16258,16293,
16259,16295,
16266,29079,29080,
16253,16298,16299,16300,16301,
16255,16302,16303,16304,16305,
17485,17486,17487,17488,17489,
16252,16306,16307,16308,16309,
16268,
16269,
12295,12676,12677,12678,12679,
16487,16489,16492,
16493,16494,
16511,
16513,16514,16515,16719,16720,
16538,16539,16540,16541,16542,
16578,16579,16580,16581,16582,
16757,16758,
16689,
16814,16815,16816,16817,16818,
16821,16822,16823,16824,16825,
16819,16820,
16833,16834,16835,
16836,16839,16840,
16845,16846,16847,
16850,16923,16924,16925,16926,
16918,16919,16920,
16864,
16880,
16896,16897,16899,16900,16901,
16902,16903,16904,16905,16906,
16909,16910,16911,16912,16913,
24858,
16929,16930,16931,16932,16933,
16858,16859,16860,16861,16862,
16934,16935,16936,16937,16938,
16940,16941,
16942,16943,16944,
16947,16948,16949,16950,16951,
16952,16954,
16958,16961,
16966,16968,
16972,16974,16975,
16979,
16998,16999,
17002,24866,
17003,17004,17005,17006,24894,
17007,
17050,17051,17053,17054,17055,
17056,17058,17059,17060,17061,
17063,17065,17066,17067,17068,
17069,17070,17071,17072,17073,
17074,17075,17076,17077,17078,
17079,17082,
5570,
17104,24943,24944,24945,24946,
17106,17107,17108,
17111,17112,17113,
17116,
17118,17119,17120,17121,17122,
17123,17124,
24968,24969,24970,24971,24972,
18562,
17322,17323,17325,
17364,
17245,17247,17248,17249,
17778,17779,17780,17781,17782,
17788,17789,17790,17791,17792,
17793,17796,17801,17802,17803,
17815,17833,17834,17835,17836,
17877,
17917,17918,
17927,17929,17930,17931,17932,
17954,17955,17956,17957,17958,
17959,
17962,
18130,18131,18132,18133,18134,
18119,18120,18121,18122,18123,
18126,18127,
18128,18129,
18135,18136,
18096,18073,
17783,17784,17785,17786,17787,
18094,18095,
17810,17811,17812,17813,17814,
17804,17805,17806,17807,17808,
18174,18175,18176,18177,18178,
18179,18180,18181,
18182,18183,
18218,18219,
18220,
18265,
18271,18272,18273,18274,18275,
18288,
18223,
18310,18311,18312,18313,
18213,18372,
17864,18393,
18427,18428,18429,
14171,14172,14173,
18459,18460,
18462,18463,18464,
16857,
18530,18531,18533,18534,18535,
18551,18552,18553,18554,18555,
18544,18547,18548,18549,18550,
18692,18693,
18694,18695,18696,
18697,18698,18699,18700,18701,
18703,18704,
18705,18706,18707,
18708,
18709,18710,
18748,18749,18750,18751,18752,
18731,18743,18744,18745,18746,
18754,18755,18756,
23785,23822,23823,23824,23825,
18767,18768,
18769,18770,18771,18772,18773,
18774,18775,
18788,
19028,
18821,18822,18823,18824,18825,
18827,18829,18830,
19151,19152,19153,
19168,19180,19181,24296,24297,
19184,19387,19388,19389,19390,
19228,19232,19233,19234,19235,
19239,19245,
19263,
19286,19287,
19290,19294,24283,
19295,19297,19298,19301,19300,
19306,
19370,19371,19373,
19376,19377,
19386,
19407,19412,19413,19414,19415,
19416,19417,19418,19419,19420,
19421,19422,19423,19424,19425,
19426,19427,19429,19430,19431,
19434,
19454,19455,19456,19457,19458,
19461,19462,24691,
19464,19465,19466,19467,19468,
19485,19487,19488,19489,19490,
19491,19493,19494,
19498,19499,19500,
19503,
19506,
19507,19508,19509,19510,19511,
19549,19550,19551,24386,24387,
19552,19553,19554,19555,19556,
19559,19560,
19572,19573,
19574,
19577,
19578,20895,
19583,19584,19585,19586,19587,
19590,19592,
19596,
19598,19599,19600,19601,19602,
19609,19610,19612,
19616,19617,19618,19619,19620,
19621,19622,19623,19624,19625,
20042,20045,20046,20047,20048,
20049,20056,20057,20058,20059,
20060,20061,20062,20063,20064,
20091,20092,
20101,20102,20103,20104,20105,
20218,
20111,20112,20113,
20117,20118,20119,20120,20121,
20127,20130,20135,20136,20137,
20138,20139,20140,20141,20142,
20143,20144,20145,20146,20147,
20148,20149,20150,
20174,20175,
20177,20179,20181,20180,20182,
20196,20197,20198,20199,20200,
20925,
20911,
20205,20206,20207,20209,20208,
20216,
26573,
20066,
20217,
20234,20235,
20237,20238,20239,
20244,20245,
20257,20258,20259,20260,20261,
20262,20263,20264,20265,20266,
20210,20212,20213,20214,20215,
20224,20225,20330,20331,20332,
20335,20336,20337,
20359,20360,20361,
20375,
20468,20469,20470,
20473,
20487,20488,20489,
20500,20501,
20502,20503,
20504,20505,
20711,
23584,23585,23586,23587,23588,
12298,12724,12725,12726,12727,
19159,19160,
19255,19256,19257,19258,19259,
24293,24294,24295,
19557,19558,
24443,19575,
20254,20255,20256,
5923,5924,5925,5926,25829,
9453,25836,
20096,20097,20098,20099,20100,
20189,20192,20193,
25956,25957,
9799,25988,
9452,26016,26021,
26022,26023,
27789,27790,
27811,27815,27816,
724,
27839,27840,
29074,29075,29076,
28996,28997,28998,
28999,29000,
29062,29064,29065,
29082,29084,29086,29087,29088,
30160,29179,29180,
29187,29189,29191,
29192,29193,
29206,29205,29202,
29438,29439,29440,
29441,29444,29445,29446,29447,
30892,30893,
30894,30895,
30902,30903,30904,30905,30906,
30919,30920
}

-------------------------------------------------------------------------------
-- Convert raw data into usable
-------------------------------------------------------------------------------
for TalentIndex = 1, #RawTalentSpellIDs do
  local SpellID = RawTalentSpellIDs[TalentIndex]
  local Name = GetSpellInfo(SpellID)
  local TalentSpellID = TalentSpellIDs[Name]

  if TalentSpellID == nil then
    TalentSpellID = {}
    TalentSpellIDs[Name] = TalentSpellID
  end

  TalentSpellID[#TalentSpellID + 1] = SpellID
end

-------------------------------------------------------------------------------
-- GetTalentInfo
--
-- Works the same as GetTalentInfo but includes a spell ID
-------------------------------------------------------------------------------
function GUB.Talents:GetTalentInfo(TabIndex, TalentIndex)
  local Name, Icon, Tier, Column, Rank = GetTalentInfo(TabIndex, TalentIndex)
  local TalentSpellID = TalentSpellIDs[Name]
  local SpellID

  if TalentSpellID == nil then
    SpellID = 0
  else
    SpellID = TalentSpellID[Rank == 0 and 1 or Rank] or 0
  end

  return Name, Icon, Tier, Column, Rank, SpellID
end



